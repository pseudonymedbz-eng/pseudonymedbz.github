<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Steal the Brainrot - Fortnite</title>
<style>
body {margin:0;padding:0;font-family:Arial,sans-serif;background:#111;color:#fff;}
.content {padding:20px;}
.comment-section {background: rgba(30,30,50,0.9); padding:20px; border-radius:10px; margin:20px 0;}
input, textarea, button {width:100%;padding:10px;margin-top:5px;border-radius:5px;border:none;}
button {background:#00ffff;color:#000; font-weight:bold; cursor:pointer;}
.comment {background: rgba(255,255,255,0.1); padding:10px; border-radius:5px; margin-bottom:10px;}
.delete-btn {background:#ff4444;color:#fff;padding:5px 10px;border:none;border-radius:5px;cursor:pointer;margin-left:10px;}
</style>
</head>
<body>
<div class="content">
  <h1>Steal the Brainrot - Fortnite</h1>

  <h2>üí¨ Commentaires des joueurs</h2>
  <div class="comment-section">
    <div id="comments"></div>
    <input id="username" placeholder="Ton pseudo">
    <textarea id="message" placeholder="Ton message..."></textarea>
    <button onclick="submitComment()">Envoyer</button>
  </div>

  <!-- Admin -->
  <div id="adminLogin" style="display:none;" class="comment-section">
    <h3>üîê Espace Admin</h3>
    <div id="adminComments"></div>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAAc2r6FQw66MrkUNmfEhw_RQq2gqJmb_o",
    authDomain: "stealthebrainrot-fortnite.firebaseapp.com",
    projectId: "stealthebrainrot-fortnite",
    storageBucket: "stealthebrainrot-fortnite.firebasestorage.app",
    messagingSenderId: "1027380486749",
    appId: "1:1027380486749:web:da177abdbbd569947fa3b4",
    measurementId: "G-6L2XGK4282"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const commentsDiv = document.getElementById("comments");
  const adminDiv = document.getElementById("adminComments");

  // Affichage en temps r√©el des commentaires
  const commentsRef = collection(db, "comments");
  const q = query(commentsRef, orderBy("date", "asc"));

  onSnapshot(q, (snapshot) => {
    commentsDiv.innerHTML = "";
    adminDiv.innerHTML = "";
    snapshot.forEach(docSnap => {
      const c = docSnap.data();
      const div = document.createElement("div");
      div.className = "comment";
      div.innerHTML = `<strong>${c.user}</strong> : ${c.msg}`;

      // Ajouter bouton supprimer si admin connect√©
      if (window.isAdmin) {
        const del = document.createElement("button");
        del.textContent = "Supprimer";
        del.className = "delete-btn";
        del.onclick = async () => {
          await deleteDoc(doc(db, "comments", docSnap.id));
        };
        div.appendChild(del);
      }

      commentsDiv.appendChild(div);
      adminDiv.appendChild(div.cloneNode(true)); // m√™me affichage dans admin
    });
  });

  // Ajouter un commentaire
  window.submitComment = async () => {
    const user = document.getElementById("username").value.trim();
    const msg = document.getElementById("message").value.trim();
    if (!user || !msg) { alert("Remplis pseudo et message !"); return; }
    await addDoc(commentsRef, {user, msg, date: Date.now()});
    document.getElementById("username").value = "";
    document.getElementById("message").value = "";
  }

  // Gestion de l'acc√®s admin
  window.isAdmin = false;
  function openAdmin(){
    const code = prompt("Code admin :");
    if(code === "2711"){
      window.isAdmin = true;
      document.getElementById("adminLogin").style.display = "block";
      alert("Acc√®s admin activ√© !");
    } else {
      alert("Code incorrect !");
    }
  }

  // D√©tecte clic Ctrl + A ou emoji (tu peux ajouter un emoji sur la page)
  document.addEventListener("keydown", e => {
    if(e.ctrlKey && e.key === "a"){ openAdmin(); }
  });

</script>
</body>
</html>
